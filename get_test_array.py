import os
import cv2
import numpy as np
import matplotlib.image as mi

dataset = []  # 数据集列表
labels = []  # 标签列表
label = 0  # 第一个标签
# 1022个汉字对应的文件夹编号
# lst = ['02048', '00016', '00733', '00651', '01012', '01600', '01570', '03473', '02315', '02691', '02392', '02525', '03269', '01024', '01103', '00780', '00992', '02827', '02403',
#        '02845', '00476', '02808', '01231', '02396', '02744', '02531', '03690', '00765', '00856', '01057', '01824', '01339', '01576', '02344', '03231', '03388', '01497', '00990',
#        '01075', '01059', '02119', '02287', '01235', '02432', '03072', '03285', '00407', '01338', '00260', '02580', '00886', '00917', '01626', '00644', '02450', '00285', '02151',
#        '03323', '00932', '02059', '00002', '02386', '00341', '01662', '03530', '00649', '01996', '02897', '00145', '00732', '00356', '00234', '01278', '02838', '02667', '00026',
#        '03073', '02423', '01577', '02383', '03622', '00593', '00120', '00670', '00332', '01835', '02564', '00531', '01034', '02349', '03421', '01270', '01540', '01620', '00689',
#        '00499', '03159', '00262', '01375', '02750', '01115', '03362', '00065', '01138', '01534', '00336', '00785', '00021', '03051', '01983', '00151', '01524', '00040', '00182',
#        '03507', '01394', '00470', '03417', '01619', '00096', '00523', '01592', '01287', '00146', '01637', '01065', '00875', '01108', '00988', '00525', '00929', '02019', '01596',
#        '00430', '00592', '02489', '00510', '02203', '00072', '00242', '02633', '00236', '00587', '02193', '01076', '02784', '02747', '00904', '03048', '02833', '00256', '02749',
#        '00035', '03649', '00090', '01940', '00437', '01589', '01370', '03084', '00364', '02155', '01135', '01274', '02433', '00098', '03162', '00903', '03442', '03602', '03741',
#        '01095', '01553', '01603', '03053', '03305', '01745', '01664', '01916', '00865', '03115', '00326', '00749', '03542', '00323', '01863', '00979', '00983', '01585', '01535',
#        '00115', '00163', '00522', '03499', '03098', '00532', '00403', '02561', '01092', '00424', '00840', '01966', '00301', '03182', '00287', '00862', '02504', '00884', '02204',
#        '02268', '03541', '03670', '02342', '00112', '01506', '02277', '02585', '02213', '02565', '00455', '02554', '01549', '00179', '00117', '00243', '02864', '00289', '02142',
#        '03500', '00212', '01587', '02201', '00122', '00269', '00132', '02157', '01010', '00240', '01397', '03738', '03233', '00740', '03618', '01507', '02824', '00318', '02215',
#        '03085', '02470', '00194', '00809', '02528', '02303', '03535', '01588', '03623', '00402', '00073', '01515', '00012', '00879', '02627', '01586', '01809', '00509', '02314',
#        '00328', '00666', '02444', '03070', '01867', '00482', '01755', '00743', '00861', '03538', '00387', '00175', '03565', '01094', '01584', '00340', '02291', '01100', '01475',
#        '03591', '00214', '01372', '02284', '01142', '03114', '00486', '01832', '01566', '02150', '03174', '00238', '03170', '01850', '02526', '03213', '02362', '01021', '00322',
#        '01097', '01107', '03526', '02422', '00265', '01086', '00471', '03329', '02269', '00871', '01657', '00062', '00082', '01406', '00070', '00986', '00084', '00255', '01045',
#        '01609', '02101', '01845', '02598', '03078', '00130', '02611', '01013', '02445', '00700', '02671', '02737', '02576', '00726', '00209', '00245', '01200', '01581', '01696',
#        '02065', '00747', '02998', '00413', '03700', '00022', '00564', '00198', '00632', '01922', '01127', '03124', '00517', '00390', '02187', '02570', '00653', '01881', '02955',
#        '00254', '00325', '00752', '02109', '01042', '00997', '00779', '00080', '02512', '00373', '01557', '03543', '01598', '00352', '01771', '00542', '03445', '03333', '00705',
#        '00153', '00982', '01243', '02583', '00037', '00416', '02729', '00261', '00277', '02152', '00191', '01496', '02641', '02454', '00420', '00528', '00006', '00797', '03672',
#        '00011', '00443', '00487', '01504', '03414', '01798', '00654', '00097', '03007', '00573', '01901', '03067', '00103', '00491', '00957', '00181', '00657', '00867', '03557',
#        '00660', '00874', '03640', '02781', '02358', '02369', '01505', '00837', '02103', '02294', '02509', '01905', '03546', '00279', '00428', '03209', '01474', '03228', '03064',
#        '03041', '03054', '00698', '00870', '00924', '01234', '01622', '02650', '00558', '03121', '03299', '00391', '02605', '00116', '02393', '03069', '03599', '03167', '03094',
#        '00019', '00148', '00409', '01717', '00934', '03322', '00453', '02093', '01405', '02452', '03265', '00297', '02168', '03314', '03564', '03594', '00312', '02353', '00442',
#        '00057', '01257', '03211', '00996', '00746', '00989', '00850', '01666', '02755', '00399', '01624', '00908', '02798', '03267', '00024', '03697', '00005', '00273', '01111',
#        '03382', '03052', '02673', '00759', '01518', '02563', '01787', '00439', '02690', '02699', '01756', '00335', '02809', '00282', '01393', '00927', '01578', '03277', '03261',
#        '00673', '01884', '02347', '02398', '03629', '01785', '00753', '03252', '01542', '02300', '01511', '03350', '01288', '01312', '01875', '02484', '00008', '02195', '01152',
#        '03087', '00170', '00324', '00134', '00415', '00051', '03316', '00663', '01247', '02811', '01536', '03302', '00496', '02672', '00278', '01843', '02584', '02339', '03338',
#        '00069', '01260', '00426', '02271', '03598', '00750', '00319', '03273', '00003', '00404', '01079', '03298', '00087', '00133', '00918', '00199', '02499', '00652', '00118',
#        '00147', '00911', '02239', '02646', '02655', '03348', '01176', '01251', '01733', '01943', '01508', '02435', '03749', '00127', '00467', '01232', '00143', '00183', '00745',
#        '02813', '02637', '02197', '02086', '03000', '03215', '00038', '00128', '00658', '00257', '03328', '00449', '03189', '00505', '02740', '03042', '01612', '03418', '01757',
#        '01617', '00064', '01058', '03524', '01605', '03631', '01202', '00776', '00027', '00248', '01356', '01451', '02336', '00311', '00704', '01408', '01653', '01022', '01489',
#        '02475', '01790', '02636', '01601', '02595', '00054', '02020', '01246', '00327', '01137', '02130', '00056', '02223', '00885', '03025', '03582', '01613', '03576', '01000',
#        '02202', '03024', '00480', '02600', '02979', '02165', '03570', '00462', '01258', '01980', '00074', '03135', '02302', '02084', '02592', '00771', '02472', '00429', '00662',
#        '02780', '00748', '01890', '03306', '01954', '00719', '00244', '00869', '01532', '02158', '00848', '01009', '02479', '00213', '00258', '03646', '02617', '00039', '00337',
#        '00741', '01512', '01640', '02412', '02508', '00643', '00431', '03081', '03514', '03532', '00742', '00860', '03745', '01627', '03082', '01780', '01633', '01500', '00553',
#        '03486', '00400', '01063', '01468', '01530', '00702', '01575', '01856', '00845', '03294', '03708', '02144', '02830', '02858', '00763', '02042', '03257', '03527', '01526',
#        '00493', '02550', '03601', '03181', '00916', '00252', '01300', '03337', '00762', '00354', '00838', '02305', '00088', '00330', '01132', '00032', '01271', '01645', '01336',
#        '01014', '03262', '01469', '01777', '03711', '01958', '03579', '00506', '00095', '03432', '01872', '01387', '02704', '03321', '01807', '01985', '01487', '00369', '00155',
#        '00374', '01122', '02868', '03547', '00013', '00092', '01280', '01747', '03534', '01110', '00518', '02293', '01098', '01479', '02581', '03303', '00066', '00756', '00944',
#        '02296', '03529', '01792', '03076', '01129', '01860', '02414', '02306', '02299', '00538', '02537', '00477', '02883', '00492', '01618', '01862', '02112', '02424', '00067',
#        '00180', '00892', '00463', '00472', '00427', '00344', '00468', '01778', '00210', '00077', '01027', '00009', '00458', '03310', '00363', '02205', '00949', '01033', '00018',
#        '00368', '01648', '00108', '01325', '03066', '01938', '00943', '01709', '01484', '00801', '03326', '02783', '00930', '01693', '00362', '00900', '02716', '01520', '01744',
#        '00166', '00156', '00481', '01037', '01803', '01335', '00755', '00135', '00905', '03403', '00894', '03648', '01514', '01516', '03008', '02368', '01970', '00646', '01082',
#        '01663', '00333', '00751', '02210', '01975', '01495', '03308', '00169', '03549', '00286', '02724', '00253', '03531', '03578', '00411', '01472', '00456', '01166', '00479',
#        '01606', '01730', '01467', '01077', '01023', '00488', '01769', '02628', '01120', '01695', '00347', '00189', '00434', '02541', '03227', '00846', '01816', '01572', '02456',
#        '01473', '00251', '00346', '00881', '00450', '02100', '01599', '02898', '00033', '03061', '01384', '03109', '00915', '00360', '00876', '01269', '03050', '03450', '03621',
#        '00910', '00110', '02711', '03736', '01038', '02881', '02018', '03020', '02015', '00645', '03103', '03503', '00408', '02104', '03619', '03045', '00365', '01579', '00473',
#        '01590', '01661', '02994', '03266', '02492', '02238', '02022', '02076', '00736', '03378', '03340', '02071', '02837', '01395', '01090', '00760', '02841', '01491', '02938',
#        '03307', '00152', '00071', '03439', '01304', '00444', '02670', '03149', '03117', '03044', '01458', '01198', '01471', '01846', '02589', '01352', '03220', '01029', '02608',
#        '00735', '01758', '01891', '00459', '00007', '00315', '00461', '00912', '03415', '02552', '01193', '00457', '02876', '03292', '01754', '02575', '02894', '01665', '01096',
#        '02529', '03568', '00259', '01267', '01834', '01880', '01885', '00781', '01424', '02579', '03046', '03411', '00367', '00419', '00452', '00000', '00293', '03169', '00841',
#        '02728', '02166', '01070', '01611', '02438', '03216', '03112', '00052', '01277', '00613', '01523', '01804', '00478', '00674', '03528']
lst = ['0', '2', '3', '5', '6', '7', '8', '9', '11', '12', '13', '16', '18', '19', '21', '22', '24', '26', '27', '32', '33', '35', '37', '38', '39', '40', '51', '52', '54', '56',
       '57', '62', '64', '65', '66', '67', '69', '70', '71', '72', '73', '74', '77', '80', '82', '84', '87', '88', '90', '92', '95', '96', '97', '98', '103', '108', '110', '112',
       '115', '116', '117', '118', '120', '122', '127', '128', '130', '132', '133', '134', '143', '145', '146', '147', '148', '151', '152', '153', '155', '156', '163', '166',
       '169', '170', '175', '179', '180', '181', '182', '183', '189', '191', '194', '198', '199', '209', '210', '212', '213', '214', '234', '236', '238', '240', '242', '243',
       '244', '245', '248', '251', '252', '253', '254', '255', '256', '257', '258', '259', '260', '261', '262', '265', '269', '273', '277', '278', '279', '282', '285', '286',
       '287', '289', '293', '297', '301', '311', '312', '315', '318', '319', '322', '323', '324', '325', '326', '327', '328', '330', '332', '333', '335', '336', '340', '341',
       '344', '346', '347', '352', '356', '360', '362', '363', '364', '365', '367', '368', '369', '373', '374', '387', '390', '391', '399', '400', '402', '403', '404', '407',
       '408', '409', '413', '415', '419', '420', '424', '426', '427', '428', '429', '430', '431', '434', '437', '439', '442', '443', '444', '449', '450', '452', '453', '455',
       '456', '457', '458', '459', '461', '462', '463', '467', '468', '470', '471', '472', '473', '476', '477', '478', '479', '480', '481', '482', '486', '487', '488', '491',
       '492', '493', '496', '499', '505', '506', '509', '510', '517', '518', '522', '525', '528', '531', '532', '538', '542', '553', '558', '564', '573', '587', '592', '613',
       '632', '643', '644', '645', '646', '649', '651', '652', '653', '654', '657', '658', '660', '662', '663', '666', '670', '673', '674', '689', '698', '700', '702', '704',
       '705', '719', '726', '732', '733', '735', '736', '740', '741', '742', '743', '745', '746', '747', '748', '749', '750', '751', '752', '753', '755', '756', '759', '760',
       '762', '765', '771', '776', '779', '780', '781', '797', '801', '809', '837', '838', '840', '841', '845', '846', '848', '856', '860', '861', '862', '865', '867', '869',
       '871', '874', '875', '876', '881', '884', '885', '886', '892', '894', '900', '903', '904', '905', '908', '910', '911', '912', '915', '916', '917', '918', '924', '927',
       '929', '930', '932', '934', '943', '944', '949', '957', '979', '982', '983', '986', '988', '989', '990', '992', '996', '997', '1000', '1009', '1010', '1012', '1013', '1014',
       '1021', '1022', '1023', '1024', '1027', '1029', '1033', '1034', '1037', '1038', '1042', '1045', '1057', '1058', '1059', '1063', '1065', '1070', '1075', '1076', '1077',
       '1079', '1082', '1086', '1090', '1092', '1094', '1095', '1096', '1097', '1098', '1100', '1103', '1107', '1108', '1110', '1111', '1115', '1120', '1122', '1127', '1129',
       '1132', '1135', '1137', '1138', '1142', '1152', '1166', '1176', '1193', '1198', '1200', '1202', '1231', '1232', '1234', '1235', '1243', '1246', '1247', '1251', '1257',
       '1258', '1260', '1267', '1269', '1270', '1271', '1274', '1277', '1278', '1280', '1287', '1288', '1300', '1304', '1312', '1325', '1335', '1336', '1338', '1339', '1352',
       '1356', '1370', '1372', '1375', '1384', '1387', '1393', '1394', '1395', '1397', '1405', '1406', '1408', '1424', '1451', '1458', '1467', '1468', '1469', '1471', '1472',
       '1474', '1475', '1479', '1484', '1487', '1489', '1491', '1495', '1496', '1497', '1500', '1504', '1505', '1506', '1507', '1508', '1511', '1512', '1514', '1515', '1516',
       '1518', '1520', '1523', '1524', '1530', '1532', '1534', '1535', '1536', '1540', '1542', '1549', '1553', '1557', '1566', '1570', '1572', '1575', '1576', '1577', '1578',
       '1579', '1581', '1584', '1585', '1586', '1587', '1588', '1589', '1590', '1592', '1596', '1598', '1599', '1600', '1601', '1603', '1605', '1606', '1609', '1611', '1612',
       '1617', '1618', '1619', '1620', '1622', '1624', '1626', '1627', '1633', '1637', '1640', '1645', '1648', '1653', '1657', '1661', '1662', '1663', '1664', '1665', '1666',
       '1693', '1695', '1696', '1709', '1717', '1730', '1733', '1744', '1745', '1747', '1754', '1755', '1756', '1757', '1758', '1769', '1771', '1777', '1778', '1780', '1785',
       '1787', '1790', '1798', '1803', '1804', '1807', '1809', '1816', '1824', '1832', '1834', '1835', '1843', '1845', '1846', '1850', '1856', '1860', '1862', '1863', '1867',
       '1872', '1880', '1881', '1884', '1885', '1890', '1891', '1901', '1905', '1916', '1922', '1938', '1940', '1943', '1954', '1958', '1966', '1970', '1975', '1980', '1983',
       '1985', '1996', '2015', '2018', '2019', '2020', '2022', '2042', '2048', '2059', '2065', '2071', '2076', '2084', '2086', '2093', '2100', '2101', '2103', '2104', '2109',
       '2112', '2119', '2130', '2142', '2144', '2150', '2151', '2152', '2157', '2158', '2165', '2166', '2168', '2187', '2193', '2195', '2197', '2201', '2202', '2203', '2205',
       '2210', '2213', '2215', '2223', '2239', '2268', '2269', '2271', '2277', '2284', '2287', '2289', '2291', '2293', '2296', '2299', '2300', '2302', '2303', '2305', '2306',
       '2314', '2315', '2336', '2339', '2342', '2344', '2347', '2349', '2353', '2358', '2362', '2368', '2369', '2383', '2386', '2392', '2393', '2396', '2398', '2403', '2414',
       '2422', '2423', '2424', '2432', '2433', '2435', '2438', '2444', '2445', '2450', '2452', '2454', '2456', '2470', '2472', '2475', '2479', '2484', '2489', '2492', '2499',
       '2504', '2508', '2509', '2512', '2525', '2526', '2528', '2529', '2531', '2537', '2541', '2550', '2552', '2554', '2561', '2563', '2564', '2565', '2570', '2575', '2576',
       '2579', '2580', '2581', '2583', '2584', '2585', '2589', '2592', '2595', '2598', '2600', '2605', '2608', '2611', '2617', '2627', '2628', '2633', '2636', '2637', '2641',
       '2646', '2650', '2655', '2667', '2670', '2671', '2672', '2673', '2690', '2691', '2711', '2716', '2724', '2728', '2729', '2737', '2740', '2744', '2747', '2749', '2755',
       '2781', '2783', '2784', '2798', '2808', '2809', '2811', '2813', '2824', '2827', '2830', '2833', '2837', '2838', '2841', '2845', '2858', '2864', '2868', '2876', '2881',
       '2883', '2894', '2897', '2898', '2938', '2955', '2979', '2994', '2998', '3000', '3007', '3008', '3020', '3024', '3025', '3041', '3042', '3044', '3045', '3046', '3048',
       '3050', '3051', '3052', '3053', '3054', '3061', '3064', '3066', '3067', '3069', '3070', '3072', '3073', '3076', '3078', '3081', '3082', '3084', '3085', '3087', '3094',
       '3098', '3103', '3109', '3112', '3114', '3117', '3121', '3124', '3149', '3159', '3162', '3167', '3170', '3174', '3181', '3182', '3189', '3209', '3213', '3216', '3227',
       '3228', '3231', '3233', '3252', '3257', '3261', '3262', '3265', '3266', '3267', '3269', '3273', '3277', '3285', '3292', '3294', '3298', '3299', '3302', '3303', '3305',
       '3306', '3307', '3308', '3310', '3314', '3316', '3321', '3322', '3323', '3326', '3328', '3329', '3333', '3337', '3338', '3348', '3350', '3362', '3378', '3382', '3388',
       '3403', '3411', '3414', '3415', '3417', '3418', '3421', '3439', '3442', '3445', '3450', '3473', '3486', '3499', '3500', '3503', '3507', '3514', '3524', '3526', '3527',
       '3528', '3529', '3530', '3531', '3532', '3534', '3535', '3538', '3541', '3542', '3546', '3547', '3557', '3564', '3565', '3568', '3570', '3576', '3578', '3582', '3591',
       '3594', '3598', '3599', '3601', '3602', '3618', '3619', '3621', '3622', '3623', '3629', '3631', '3640', '3646', '3648', '3649', '3670', '3672', '3690', '3697', '3700',
       '3708', '3711', '3736', '3738', '3741', '3745', '3749']


def load_data(filepath):
    # 遍历filepath下所有文件，包括子目录
    files = os.listdir(filepath)
    for fi in files:
        fi_d = os.path.join(filepath, fi + '/')
        if os.path.isdir(fi_d):
            if fi in lst:
                global label
                load_data(fi_d)
                label += 1
        else:
            labels.append(label)
            img = mi.imread(fi_d[:-1])
            img2 = cv2.resize(img, (64, 64))  # (64,64,3)
            dataset.append(img2)

    return np.array(dataset), np.array(labels)
