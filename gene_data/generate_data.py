import os
from PIL import Image

"""
1. 切换对应的数据集路径，执行程序，生成对应的编号对应的文件数据
2. 测试集和训练集，必须取交集，对应的标签数量必须一致
3. 该方法并没有直接取交集，先生成测试集的数据（数量少），然后再生成训练集的数据，手动找出在测试集但是不在训练集的数据，去掉。
"""


def image_category():
    image_dir = "F:\\captchaFiles\\distinctTrain\\gen_words"
    image_dir2 = "F:\\captchaFiles\\distinctTrain\\gen_words_category"
    my_dict = {'便': 181, '再': 273, '种': 2423, '兴': 259, '一': 0, '热': 2059, '巩': 986, '打': 1251, '策': 2499, '节': 2813, '短': 2342, '章': 2475, '报': 1288, '领': 3631,
               '放': 1471, '引': 1065, '甚': 2193, '弱': 1075, '替': 1576, '征': 1095, '插': 1406, '液': 1922, '环': 2157, '暴': 1566, '错': 3473, '六': 255, '它': 856, '入': 251,
               '辉': 3273, '住': 148, '稻': 2445, '卵': 430, '杀': 1598, '尺': 927, '都': 3382, '生': 2195, '台': 477, '度': 1045, '张': 1070, '供': 169, '十': 402, '洋': 1872,
               '费': 3181, '知': 2339, '塞': 719, '两': 21, '吸': 517, '床': 1033, '们': 112, '稳': 2444, '二': 66, '亲': 87, '尖': 918, '州': 979, '柱': 1648, '记': 3072,
               '近': 3303, '盐': 2287, '共': 257, '讲': 3073, '点': 2042, '阀': 3514, '师': 1000, '容': 885, '未': 1588, '方': 1507, '始': 797, '重': 3415, '麦': 3736, '几': 301,
               '卫': 424, '笑': 2484, '促': 182, '代': 108, '刘': 324, '优': 128, '帮': 1013, '铜': 3450, '变': 463, '逐': 3329, '剂': 344, '绿': 2617, '于': 67, '武': 1758,
               '给': 2595, '术': 1592, '误': 3109, '心': 1110, '著': 2898, '班': 2165, '基': 705, '微': 1107, '力': 360, '格': 1666, '黑': 3741, '固': 652, '余': 153, '联': 2691,
               '林': 1624, '整': 1489, '照': 2076, '曲': 1570, '根': 1665, '施': 1508, '射': 911, '毛': 1785, '哪': 573, '牛': 2104, '王': 2152, '英': 2841, '革': 3602, '金': 3418,
               '价': 116, '儒': 234, '专': 11, '氧': 1798, '孔': 838, '关': 258, '轮': 3262, '导': 908, '农': 279, '土': 658, '百': 2269, '欧': 1747, '突': 2456, '公': 254,
               '松': 1617, '磨': 2392, '元': 238, '局': 932, '光': 243, '螺': 2994, '愈': 1198, '害': 881, '什': 90, '缸': 2636, '收': 1468, '背': 2724, '半': 407, '域': 702,
               '仅': 92, '质': 3167, '遍': 3348, '依': 170, '荣': 2864, '商': 592, '更': 1572, '造': 3338, '影': 1090, '周': 532, '美': 2650, '步': 1757, '协': 409, '咱': 553,
               '斤': 1500, '技': 1271, '艺': 2811, '示': 2396, '流': 1885, '副': 356, '算': 2508, '或': 1234, '斯': 1505, '束': 1609, '缘': 2628, '水': 1803, '产': 80, '界': 2210,
               '议': 3070, '察': 900, '省': 2303, '第': 2489, '侯': 179, '助': 368, '室': 876, '益': 2284, '名': 492, '接': 1393, '动': 367, '古': 468, '操': 1458, '刚': 326,
               '异': 1059, '缩': 2633, '草': 2858, '确': 2369, '危': 427, '数': 1487, '究': 2452, '行': 3000, '每': 1778, '迅': 3298, '食': 3649, '握': 1408, '卷': 431, '介': 96,
               '断': 1504, '然': 2071, '规': 3046, '门': 3500, '承': 1270, '藏': 2938, '怕': 1132, '溶': 1975, '续': 2608, '路': 3231, '就': 924, '巴': 992, '处': 740, '测': 1890,
               '明': 1530, '菌': 2881, '列': 323, '离': 2414, '含': 509, '润': 1916, '官': 865, '玉': 2151, '清': 1943, '应': 1037, '达': 3294, '证': 3084, '压': 439, '夏': 743,
               '磁': 2386, '成': 1231, '展': 943, '灰': 2022, '配': 3388, '备': 741, '太': 751, '找': 1269, '般': 2798, '友': 456, '教': 1479, '纪': 2565, '评': 3085, '调': 3121,
               '加': 364, '车': 3257, '务': 365, '比': 1780, '严': 22, '增': 726, '阴': 3528, '富': 894, '平': 1022, '除': 3547, '率': 2150, '抓': 1277, '积': 2432,
               '活': 1881, '雄': 3568, '振': 1356, '控': 1394, '洲': 1880, '破': 2358, '阳': 3527, '彪': 1086, '以': 110, '河': 1843, '威': 809, '志': 1115, '久': 37, '移': 2435,
               '甲': 2203, '拿': 1335, '向': 496, '失': 755, '书': 57, '治': 1846, '意': 1200, '社': 2398, '防': 3526, '才': 1247, '括': 1325, '仍': 97, '同': 491, '呢': 531,
               '类': 2526, '占': 419, '吗': 499, '夜': 747, '原': 444, '按': 1339, '晶': 1557, '芽': 2827, '映': 1535, '这': 3306, '云': 69, '殖': 1769, '京': 84, '初': 328,
               '灌': 2018, '号': 481, '士': 733, '线': 2579, '旱': 1523, '厘': 442, '反': 458, '对': 905, '齿': 3749, '约': 2563, '乡': 56, '位': 146, '激': 2015, '药': 2868,
               '用': 2197, '问': 3503, '倒': 199, '沙': 1832, '末': 1589, '秋': 2422, '科': 2424, '继': 2605, '维': 2611, '扩': 1258, '干': 1021, '决': 286, '穗': 2450,
               '简': 2504, '均': 666, '带': 1010, '提': 1405, '合': 488, '设': 3081, '现': 2158, '主': 33, '升': 404, '模': 1733, '回': 644, '营': 2894, '紧': 2554, '精': 2541,
               '看': 2305, '阿': 3532, '杂': 1599, '阶': 3530, '倾': 210, '李': 1603, '本': 1590, '查': 1645, '发': 459, '时': 1524, '辟': 3285, '管': 2509, '连': 3310, '量': 3417,
               '兰': 256, '需': 3582, '湿': 1966, '硬': 2368, '斗': 1495, '部': 3378, '华': 408, '瓦': 2187, '壤': 732, '如': 781, '减': 297, '分': 318, '矿': 2347, '削': 346,
               '直': 2299, '能': 2737, '刺': 340, '远': 3308, '研': 2353, '当': 1079, '告': 525, '服': 1581, '脚': 2747, '缺': 2637, '深': 1938, '责': 3162, '彻': 1092, '地': 662,
               '亚': 73, '唯': 587, '腐': 2755, '件': 115, '德': 1108, '担': 1300, '间': 3507, '例': 166, '求': 1807, '星': 1534, '双': 457, '上': 6, '换': 1372, '退': 3321,
               '滑': 1980, '须': 3623, '呀': 522, '贺': 3182, '党': 248, '菜': 2883, '装': 3025, '阵': 3529, '掌': 1384, '火': 2019, '封': 910, '游': 1958, '走': 3209, '历': 437,
               '八': 253, '程': 2438, '载': 3267, '烈': 2048, '中': 26, '情': 1176, '医': 400, '注': 1863, '跟': 3228, '厚': 443, '普': 1553, '槽': 1730, '府': 1042, '怎': 1129,
               '苦': 2838, '场': 663, '此': 1756, '那': 3362, '飞': 3648, '矛': 2336, '埃': 698, '军': 278, '乙': 51, '身': 3252, '端': 2479, '获': 2876, '作': 155, '组': 2581,
               '混': 1940, '践': 3233, '理': 2168, '泥': 1862, '字': 840, '与': 9, '燃': 2086, '丝': 19, '补': 3007, '裂': 3024, '资': 3189, '之': 40, '击': 312, '布': 997,
               '执': 1257, '称': 2433, '和': 542, '读': 3117, '宽': 886, '支': 1467, '属': 944, '解': 3052, '特': 2112, '何': 152, '单': 413, '止': 1754, '及': 455, '汽': 1824,
               '灭': 2020, '状': 2119, '靠': 3599, '大': 749, '血': 2998, '态': 1127, '寨': 903, '选': 3326, '兵': 260, '既': 1515, '存': 841, '北': 391, '山': 949, '世': 13,
               '础': 2362, '套': 771, '脱': 2749, '取': 461, '要': 3042, '制': 336, '壮': 735, '据': 1375, '会': 130, '岩': 957, '俄': 183, '罗': 2641, '胞': 2729, '请': 3114,
               '建': 1057, '侵': 180, '想': 1193, '劳': 373, '东': 18, '到': 335, '陈': 3538, '顺': 3622, '落': 2897, '偏': 212, '见': 3044, '较': 3269, '九': 52, '非': 3598,
               '纲': 2570, '贯': 3174, '访': 3082, '许': 3076, '风': 3646, '保': 189, '认': 3064, '球': 2166, '充': 240, '宋': 861, '起': 3213, '份': 118, '牙': 2103, '你': 156,
               '天': 750, '感': 1202, '抗': 1280, '运': 3302, '验': 3690, '争': 64, '丰': 27, '进': 3307, '护': 1287, '客': 874, '队': 3524, '并': 1024, '低': 147, '零': 3578,
               '叫': 472, '委': 801, '念': 1122, '题': 3640, '电': 2205, '举': 35, '总': 1142, '江': 1816, '千': 403, '做': 213, '夹': 759, '物': 2109, '刻': 341, '砂': 2349,
               '盒': 2289, '里': 3414, '黄': 3738, '史': 478, '期': 1586, '口': 467, '别': 333, '得': 1103, '道': 3350, '创': 327, '扬': 1260, '职': 2690, '培': 704, '田': 2201,
               '尔': 917, '被': 3020, '划': 322, '寸': 904, '将': 912, '随': 3557, '全': 252, '留': 2213, '参': 452, '降': 3541, '差': 988, '广': 1029, '够': 748, '滚': 1983,
               '南': 415, '条': 1611, '五': 71, '钻': 3442, '消': 1905, '措': 1397, '各': 487, '标': 1653, '爱': 2093, '训': 3069, '把': 1274, '且': 12, '独': 2130, '定': 867,
               '试': 3094, '轴': 3265, '酸': 3403, '鱼': 3708, '素': 2552, '枝': 1627, '轻': 3266, '体': 151, '即': 428, '季': 846, '己': 989, '相': 2300, '新': 1506, '圈': 657,
               '统': 2600, '也': 54, '鲜': 3711, '很': 1098, '因': 645, '必': 1111, '曾': 1575, '可': 476, '骨': 3697, '宜': 869, '急': 1137, '望': 1584, '杆': 1601, '叶': 480,
               '包': 387, '的': 2271, '响': 564, '工': 982, '效': 1474, '粉': 2528, '限': 3542, '顶': 3619, '通': 3333, '校': 1661, '福': 2412, '快': 1120, '已': 990, '势': 374,
               '排': 1387, '隶': 3564, '斜': 1497, '修': 194, '式': 1063, '块': 673, '献': 2144, '空': 2454, '坏': 670, '小': 915, '触': 3053, '吧': 506, '拉': 1304, '另': 470,
               '权': 1600, '法': 1856, '脑': 2744, '越': 3216, '指': 1338, '内': 269, '雨': 3576, '植': 1709, '切': 319, '学': 848, '刀': 315, '他': 103, '安': 860, '器': 632,
               '悟': 1166, '页': 3618, '纯': 2568, '族': 1512, '高': 3700, '业': 16, '弹': 1076, '战': 1235, '具': 262, '欢': 1745, '侧': 175, '喷': 613, '艰': 2808, '该': 3103,
               '阻': 3531, '碳': 2383, '析': 1622, '木': 1587, '米': 2525, '多': 746, '冷': 289, '苏': 2830, '底': 1038, '透': 3328, '日': 1516, '冲': 285, '民': 1790, '角': 3051,
               '毫': 1787, '立': 2470, '经': 2589, '表': 3008, '儿': 236, '过': 3299, '听': 510, '肥': 2711, '而': 2673, '信': 191, '孟': 845, '温': 1954, '熟': 2084, '义': 39,
               '但': 145, '架': 1633, '若': 2837, '停': 214, '努': 369, '亩': 82, '眼': 2314, '满': 1985, '海': 1901, '箱': 2512, '前': 347, '投': 1278, '疗': 2223, '纸': 2575,
               '锻': 3486, '子': 837, '次': 1744, '翻': 2667, '长': 3499, '宣': 875, '病': 2239, '克': 244, '完': 862, '自': 2781, '了': 62, '考': 2671, '强': 1077, '央': 753,
               '任': 117, '不': 8, '话': 3098, '负': 3159, '伍': 122, '派': 1884, '真': 2306, '沟': 1834, '最': 1577, '人': 88, '让': 3067, '难': 3565, '着': 2315, '序': 1034,
               '株': 1662, '先': 242, '石': 2344, '致': 2784, '倍': 198, '采': 3411, '早': 1520, '构': 1620, '否': 505, '站': 2472, '距': 3227, '为': 32, '皮': 2277, '首': 3670,
               '只': 471, '卡': 420, '市': 996, '坚': 674, '况': 287, '磷': 2393, '系': 2550, '头': 756, '迫': 3314, '波': 1860, '损': 1370, '附': 3534, '转': 3261, '家': 884,
               '文': 1491, '幼': 1027, '其': 261, '值': 209, '细': 2583, '胜': 2728, '幸': 1025, '吹': 518, '司': 482, '手': 1246, '面': 3601, '功': 363, '区': 399, '粒': 2529,
               '院': 3546, '置': 2646, '密': 892, '律': 1100, '者': 2672, '花': 2824, '觉': 3050, '么': 38, '尾': 930, '改': 1469, '神': 2403, '油': 1845, '思': 1135, '机': 1596,
               '利': 332, '预': 3629, '际': 3535, '型': 689, '还': 3305, '事': 65, '极': 1619, '奴': 776, '显': 1542, '形': 1082, '径': 1096, '朝': 1585, '速': 3337, '搞': 1424,
               '化': 390, '讨': 3066, '料': 1496, '散': 1484, '月': 1578, '往': 1094, '团': 646, '样': 1663, '拖': 1312, '众': 127, '右': 479, '我': 1232, '待': 1097, '所': 1243,
               '演': 1996, '后': 493, '政': 1472, '旋': 1511, '苗': 2833, '铁': 3445, '交': 77, '冬': 282, '剥': 352, '帝': 1009, '焊': 2065, '员': 528, '练': 2580, '说': 3112,
               '村': 1606, '旧': 1518, '青': 3594, '外': 745, '国': 653, '白': 2268, '编': 2627, '七': 2, '伟': 132, '汉': 1809, '万': 3, '层': 934, '个': 24, '终': 2585,
               '夺': 760, '困': 649, '脉': 2740, '无': 1514, '是': 1540, '露': 3591, '传': 133, '下': 7, '边': 3292, '印': 426, '绝': 2598, '奋': 765, '准': 293, '楚': 1717,
               '少': 916, '判': 330, '企': 120, '级': 2564, '没': 1835, '常': 1014, '纹': 2576, '织': 2584, '象': 3149, '果': 1626, '械': 1693, '谈': 3124, '则': 325, '写': 277,
               '城': 700, '夫': 752, '送': 3322, '适': 3323, '钱': 3439, '四': 643, '由': 2202, '左': 983, '围': 651, '挥': 1352, '盘': 2293, '去': 449, '群': 2655, '永': 1804,
               '计': 3061, '老': 2670, '虽': 2955, '井': 72, '源': 1970, '粗': 2531, '来': 1612, '推': 1395, '县': 450, '识': 3087, '受': 462, '命': 538, '盖': 2291, '段': 1771,
               '贫': 3170, '敌': 1475, '奇': 762, '猪': 2142, '从': 98, '声': 736, '片': 2100, '言': 3054, '蜂': 2979, '易': 1532, '项': 3621, '输': 3277, '尽': 929, '席': 1012,
               '批': 1267, '春': 1536, '泵': 1867, '晚': 1549, '图': 654, '似': 143, '又': 453, '吃': 486, '好': 780, '恩': 1152, '有': 1579, '材': 1605, '述': 3316, '办': 362,
               '她': 779, '三': 5, '实': 871, '养': 265, '免': 245, '使': 163, '染': 1640, '厂': 434, '开': 1058, '板': 1618, '树': 1657, '版': 2101, '色': 2809, '观': 3045,
               '今': 95, '持': 1336, '播': 1451, '结': 2592, '针': 3421, '互': 70, '性': 1138, '目': 2296, '出': 311, '范': 2845, '召': 473, '沿': 1850, '至': 2783, '某': 1637,
               '检': 1695, '集': 3570, '伤': 134, '在': 660, '红': 2561, '棉': 1696, '略': 2215, '济': 1891, '西': 3041, '些': 74, '却': 429, '年': 1023, '粮': 2537, '论': 3078,
               '正': 1755, '盾': 2302, '品': 558, '母': 1777, '等': 2492, '马': 3672, '育': 2716, '鼓': 3745, '核': 1664, '视': 3048, '复': 742}
    for file_name in os.listdir(image_dir):
        file_path = os.path.join(image_dir, file_name)
        if 'X' in file_name:
            continue
        # if os.path.isfile(file_path):
        # 打开图片并进行大小调整
        with Image.open(file_path) as img:
            # 定义目标宽度
            target_width = 32
            # 计算目标高度，以保持原始宽高比例
            # width, height = img.size
            # aspect_ratio = height / width
            # target_height = round(target_width * aspect_ratio)
            target_height = 32
            # 调整图片大小
            target_size = (target_width, target_height)
            resized_img = img.resize(target_size)
            # 将调整后的图片保存到文件
            # resized_img.save('resized_example.jpg')
            dir_ = file_path.split("\\")[4][0]  # 获取汉字作为文件夹
            if dir_ in my_dict:
                file_dir = os.path.join(image_dir2, str(my_dict[dir_]))
                if not os.path.exists(file_dir):
                    os.mkdir(file_dir)
                    print(my_dict[dir_], dir_)
                real_path = os.path.join(file_dir, file_name)
                # convert_img = resized_img.convert('L')
                # convert_img.save(real_path)
                resized_img.save(real_path)


def step3():
    """
    将训练集和测试集的数量处理一致
    """
    image_train = "F:\\captchaFiles\\distinctTrain\\gen_words_category"
    image_test = "F:\\captchaFiles\\distinctTest\\gen_words_category"
    test_lst = []
    for root, dirs, files in os.walk(image_test):
        for dir_name in dirs:
            test_lst.append(dir_name)
    train_lst = []
    for root, dirs, files in os.walk(image_train):
        for dir_name in dirs:
            train_lst.append(dir_name)

    for name in test_lst:
        if name not in train_lst:
            print(name)


def step4():
    """
        输出汉字对应的全部标签
    """
    image_train = "F:\\captchaFiles\\distinctTrain\\gen_words_category"
    for root, dirs, files in os.walk(image_train):
        for dir_name in dirs:
            print(dir_name)


if __name__ == '__main__':
    image_category()
    # step3() # 1025 2412 2568  测试集里有三个字符在训练集里没有  去掉后就可以得到 986 个字符的训练集和测试集
    step4()